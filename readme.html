<html>
  <head></head>
  <body>
    <h2>Requirements</h2>
      <p>This app requires Custom Type API Key for data inputs and SOAR Actions. Follow the steps <a href="https://developer.carbonblack.com/reference/carbon-black-cloud/authentication/" target="_blank">described here</a> to create API Keys with the appropriate permissions to start pulling in Carbon Black Cloud data.</p>
      <br>
      <h4>Set up Keys and Permissions in Carbon Black Cloud</h4>
      Custom Type Credentials
      Note: For VMware Carbon Black Cloud customers who use VMware Cloud Services Platform for Identity and Access Management, OAuth App Id and OAuth App Secret can be used.
      <ol>
        <li>Open your Carbon Black Cloud console, go to Settings > API Access, select "Access Levels" and click "Add Access Level".</li>
        <li>Fill in the "Name" and "Description" fields, grant the new Access Level with the following RBAC permissions and click Save.</li>
        <ul>
                <li>Alerts (org.alerts) - READ</li>
                <li>Alerts (org.alerts.close) - EXECUTE</li>                
                <li>Applications (org.reputations) - CREATE, DELETE</li>
                <li>Background Tasks (jobs.status) - READ</li>
                <li>Custom Detections (org.watchlists) - CREATE, READ, UPDATE, DELETE</li>
                <li>Custom Detections (org.feeds) - CREATE, READ, UPDATE, DELETE</li>
                <li>Device (device.quarantine) - EXECUTE</li>
                <li>Device (device) - READ</li>
                <li>Device (device.policy) - UPDATE</li>
                <li>Live Query (livequery.manage) - CREATE, READ, UPDATE, DELETE</li>
                <li>Live Response File (org.liveresponse.file) - READ, DELETE</li>
                <li>Live Response Process (org.liveresponse.process) - EXECUTE, READ, DELETE</li>
                <li>Live Response Session (org.liveresponse.session) - CREATE, READ, DELETE</li>
                <li>Policies (org.policies) - READ</li>
                <li>Search (org.search.events) - CREATE, READ</li>
                <li>Unified Binary Store (ubs.org.sha256) - READ</li>
                <li>Unified Binary Store (ubs.org.file) - READ</li>
        </ul>
        <li>Go to the "API Keys" tab and click "Add API Key".</li>
        <li>Enter a "Name", click on the "Access Level type" dropdown, select "Custom", click on the "Custom Access Level" dropdown and select the level you created in step 2, then click Save.</li>
        <li>Copy the API Secret Key and API ID from the pop-up modal.</li>
        <li>Copy Carbon Black Cloud console URL(including the "https://"), and ORG KEY.</li>
      </ol>

    <h2>Configure the Carbon Black Cloud SOAR app Asset</h2>
        <ol>
            <li>Open the Splunk SOAR console. Go to Apps > Unconfigured Apps > Carbon Black Cloud click Configure New Asset.</li>
            <li>Go to "Asset Info" Tab and enter "Asset name".</li>
            <li>Go to "Asset Settings" Tab and add Carbon Black Cloud instance URL, Carbon Black Cloud Org Key, API ID and API Secret Key to their respective fields. Click on the corresponding checkbox to enable fetching a specific type of alerts(CB_ANALYTICS alerts, DEVICE_CONTROL alerts, WATCHLIST alerts(requires Enterprise EDR), CONTAINER_RUNTIME alerts, HOST_BASED_FIREWALL, INTRUSION_DETECTION_SYSTEM (requires Enterprise EDR)). Select minimum alerts severity.</li>
            <li>Go to "Ingest Settings" Tab and enable polling on the asset. Select a polling interval or schedule to configure polling on this asset. The suggested Polling interval is 3 minutes. Click Save.</li>
            <li>Go back to "Asset Settings" tab and click "Test Connectivity" to ensure successful connection.</li>
        </ol>

    <h2>Port Information</h2>
    <p>
        The app uses HTTPS protocol for communicating with the Carbon Black Cloud instance. Below is the default ports used by Splunk SOAR:
        <table>
            <tr class=plain>
                <th>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Service Name</th>
                <th>Transport Protocol</th>
                <th>Port</th>
            </tr>
            <tr>
                <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;http</td>
                <td>tcp</td>
                <td>443</td>
            </tr>
        </table>
    </p>
  </body>
</html>